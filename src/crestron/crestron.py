# Crestron commercial dealers one line scraper (just paste & run the below line within a scrapy shell)
import scrapy, json, csv; open('dealers.csv', 'w').write(''); (fetch(scrapy.Request(url='https://www.crestron.com/Handlers/DealerHandler.ashx', method='POST', body='culture=en-US&start=0&lat=41.0081024169922&lng=-73.9440994262695&type=3', headers={'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8'})), [csv.DictWriter(open('dealers.csv', 'a'), fieldnames=['Customer name', 'Address', 'Website', 'Phone', 'Email']).writerow({'Customer name': item['Organization']['CustomerName'], 'Address': item['Organization']['Street1'] + ', ' + item['Organization']['City'] + ', ' + item['Organization']['Country'], 'Website': item['Organization']['Website'], 'Phone': item['Organization']['Phone'], 'Email': item['Organization']['EmailPublic']}) for item in json.loads(response.text)['Results']])
