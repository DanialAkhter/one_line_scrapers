# courses scraper (https://classes.oregonstate.edu/)
import scrapy, json, csv; open('courses.csv', 'w').write('code,title,descripton\n'); (fetch(scrapy.Request(url='https://classes.oregonstate.edu/api/?page=fose&route=search&coursetype_01=Y', method='POST', body='%7B%22other%22%3A%7B%22srcdb%22%3A%22202101%22%7D%2C%22criteria%22%3A%5B%7B%22field%22%3A%22coursetype_01%22%2C%22value%22%3A%22Y%22%7D%5D%7D')), [(fetch(scrapy.Request(url='https://classes.oregonstate.edu/api/?page=fose&route=details', meta={'code': course['code'], 'title': course['title']}, method='POST', body=json.dumps({'group': 'code:' + course['code']}))), csv.DictWriter(open('courses.csv', 'a'), ['code', 'title', 'description']).writerow({'code': response.meta.get('code'), 'title': response.meta.get('title'), 'description': json.loads(response.text)['description']})) for course in json.loads(response.text)['results']])
